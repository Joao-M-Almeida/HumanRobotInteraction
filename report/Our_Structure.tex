\section{Our Structure}
\begin{figure}[!h]
    \centering
    \includegraphics[width=0.5\columnwidth]{./OurStructure.png}
    \caption{Adele's Structure}
    \label{fig:adele_structure}
\end{figure}

\subsection{Kinect Node: Gestures}
Gesture recognition can be performed by tracking the movements of the different parts of the body. Once a stable detection of the joints is made, following them is the starting point towards the gesture recognition. 

Using a tracking software, the stable detection was achieved using a median filter of 5 samples.  Extracting these features from the image allow the construction of small movements and/or complete gestures. From points representing joints it's straightforward to use vectors to represent parts of the body like arm and forearm. Relations between them, such as angles or distances perform a good way to detect movements independent from the camera's referential.  

Not only the dislocation of the joints positions but also features as velocities and accelerations are detected. This way small movements are recognize as opening and closing the forearm or the arm moving up as well as moving down. In this work the goal is the prevision of gestures, therefore it is fundamental to detect small movements from which the gesture is built. The small movements include the variation position of the hand regarding the elbow, the position of the elbow regarding the torso, the amplitude between forearm and arm and the amplitude of the arm regarding the torso. More than one gesture can be built using the same small movements.

In order to help the system recognizing more accurately the gestures we included in this work the detection of waving, calling and handing gestures using the movements previously described.

Furthermore, it is also included detection of the position of the person in the world frame and the person's velocity. As for simplifying purposes it was decided to only work in one spatial dimension, the position is detected by computing the distance between the person and the kinect camera based on the mean of the points given by the hips, neck and torso. 

\subsection{Action Node: Katana \& Scout Movement}
\subsubsection{Katana}
As mentioned in section \ref{Material: Katana} with help of the \textit{ROS} package \textit{Katana Native Interface} it is possible to power-off the motors of the robotic arm while keeping the robot communicating with the computer.

While the motors are off, one can move the arm to the desired positions and afterwards read the values of the joint positions. Doing this repeatedly using all the desired positions, it is possible to program movement sequences, creating a gesture. After having each step of the movement, we programmed the maximum time for executing each step of the gesture. As well as for the positions, these maximum times were empirically determined. In the end of each movement, Katana goes to a defined default position.

Using this line of thought we created the following gestures: high-five, low-five, clap, wave, pass the slide and grab.

Since Katana as 7 degrees of freedom (6 joints and the gripper), the structures sent to Katana are a vector with 7 entries.
\begin{center}
General structure:
$\left[ Joint1, Joint2, Joint3, Joint4, Joint5, Joint6, Gripper\right]$\\
\end{center}
Using as an example the gesture "wave", the maximum time for reaching each position and the position goal sequence are given by:
\begin{center}
Maximum time:
$\left[5, 1.3, 1.3, 1.3, 5\right]$\\
\end{center}
\begin{table}[!h]
\centering
\begin{tabular}{lc}
Position 1: & {[}-1.85, 1.57, 0.175, -0.35, -1.57, 0.175, 0.175{]} \\
Position 2: & {[}-1.85, 1.57, 0.175, 0.35, -1.57, 0.175, 0.175{]}  \\
Position 3: & {[}-1.85, 1.57, 0.175, -0.35, -1.57, 0.175, 0.175{]} \\
Position 4: & {[}-1.85, 1.57, 0.175, 0.35, -1.57, 0.175, 0.175{]}  \\
Position 5: & Default Position                                    
\end{tabular}
\caption{Wave Sequence}
\label{wave}
\end{table}

Looking at the table~\ref{wave} we can observe that in this movement the only joint that changes its position is Joint 4, similar to the human gesture where the only joint that moves while waving is the elbow joint.

\subsubsection{Scout}
The Scout robot is a two wheel, two motor differential drive robot, that means that for controlling the robot, one needs a linear and an angular velocity. One can translate these two velocities to the velocities of each wheel, by using following equations:
\begin{equation}
v_{lin} = \frac{(\omega_{right}+\omega_{left})r}{2} \\
\end{equation}
\begin{equation}
v_{ang} = \omega = \frac{(\omega_{right}-\omega_{left})r}{2d}
\end{equation}
Where $r$ represents the radius of the wheel, and $d$ the distance between wheels.
As it can be seen in figure \ref{fig:scout_axis} our robot has two degrees of freedom, but since the movement of the robot isn't the main point of this project, we assume, as a proof of concept, to only move in the \textit{x}-axis (forwards and backwards).

The implemented controller receives as an input a dislocation. The idea of having as input a final position in the world map, is a possible improvement for future work, but requires the robot tracking by the Kinect Node.

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.5\columnwidth]{./ScoutAxis.png}
    \caption{Scout Axis}
    \label{fig:scout_axis}
\end{figure}
The control loop that we implemented looks as shown in figure \ref{fig:scout_loop}.
\begin{figure}[!h]
    \centering
    \includegraphics[width=\columnwidth]{./ControlLoopScout.png}
    \caption{Scout's Control Loop}
    \label{fig:scout_loop}
\end{figure}

\subsection{Decision Node: Probabilistic Model}
hello, its me\dots

\begin{table}[!h]
\centering
\label{tab:expected_response}
\begin{tabular}{|c|c|}
\hline
\textbf{Person gesture/movement} & \textbf{What we expect Adele to do?} \\ \hline
Waving                           & Wave                                 \\
Handing an object                & Grabbing                             \\
Calling                          & Go meet user                         \\
Go away                          & Return to home                       \\
High-Five                        & Low-Five                             \\
Low-Five                         & High-Five                            \\
Random                           & NOP                                  \\ \hline
\end{tabular}
\caption{Expected response}
\end{table}


\begin{table}[]
\centering
\begin{tabular}{cccccccc}
Previous|Next                        & \textbf{NOP} & \textbf{Wave} & \textbf{H5} & \textbf{L5} & \textbf{Go} & \textbf{Grab} & \textbf{Return} \\ \cline{2-8} 
\multicolumn{1}{c|}{\textbf{NOP}}    & 1/7          & 1/7           & 1/7         & 1/14        & 1/7         & 3/14          & 1/7             \\
\multicolumn{1}{c|}{\textbf{Wave}}   & 1/7          & 0             & 0           & 1/7         & 3/7         & 2/7           & 0               \\
\multicolumn{1}{c|}{\textbf{H5}}     & 1/6          & 1/6           & 0           & 1/6         & 1/6         & 1/6           & 1/6             \\
\multicolumn{1}{c|}{\textbf{L5}}     & 2/7          & 0             & 0           & 0           & 0           & 2/7           & 3/7             \\
\multicolumn{1}{c|}{\textbf{Go}}     & 1/14         & 0             & 1/7         & 1/7         & 0           & 3/7           & 3/14            \\
\multicolumn{1}{c|}{\textbf{Grab}}   & 2/7          & 0             & 1/7         & 1/7         & 0           & 0             & 3/7             \\
\multicolumn{1}{c|}{\textbf{Return}} & 1/6          & 1/6           & 1/6         & 1/6         & 1/6         & 1/6           & 0              
\end{tabular}
\caption{My caption}
\label{my-label}
\end{table}